-- Seed –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–ï–ó Supabase Auth
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç SQL –≤ Supabase SQL Editor

-- –í–ê–ñ–ù–û: –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ foreign key
ALTER TABLE profiles DROP CONSTRAINT IF EXISTS profiles_id_fkey;

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∫–∏–µ —Ä–æ–ª–∏ –¥–æ–ø—É—Å—Ç–∏–º—ã
-- –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —ç—Ç—É —Å—Ç—Ä–æ–∫—É —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
-- \d profiles

-- 1. –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
-- –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–æ–ª–∏ –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ —Å–∏—Å—Ç–µ–º–µ
INSERT INTO profiles (id, full_name, role, department, position, created_at, updated_at) VALUES 
('d0d5e7a0-1111-1111-1111-111111111111', '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã', 'admin', 'IT', '–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', NOW(), NOW()),
('d0d5e7a0-2222-2222-2222-222222222222', '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞', 'employee', 'HR', 'HR –º–µ–Ω–µ–¥–∂–µ—Ä', NOW(), NOW()),
('d0d5e7a0-3333-3333-3333-333333333333', '–ü–µ—Ç—Ä –°–∏–¥–æ—Ä–æ–≤', 'employee', '–ü—Ä–æ–¥–∞–∂–∏', '–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º', NOW(), NOW())
ON CONFLICT (id) DO UPDATE SET
  full_name = EXCLUDED.full_name,
  role = EXCLUDED.role,
  department = EXCLUDED.department,
  position = EXCLUDED.position,
  updated_at = NOW();

-- –ï—Å–ª–∏ —Ä–æ–ª—å 'employee' –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —ç—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã:
-- 'student', 'instructor', 'moderator'

-- 2. –°–æ–∑–¥–∞–µ–º –∫–∞–Ω–∞–ª—ã –ª–µ–Ω—Ç—ã
INSERT INTO feed_channels (id, name, slug, description, icon, color, is_official, creator_id, created_at) VALUES
('c0c5e7a0-1111-1111-1111-111111111111', '–ù–æ–≤–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏', 'company-news', '–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è', 'üì¢', '#3B82F6', true, 'd0d5e7a0-1111-1111-1111-111111111111', NOW()),
('c0c5e7a0-2222-2222-2222-222222222222', '–û–±—É—á–µ–Ω–∏–µ –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ', 'learning', '–ù–æ–≤–æ—Å—Ç–∏ –æ –∫—É—Ä—Å–∞—Ö –∏ —Ç—Ä–µ–Ω–∏–Ω–≥–∞—Ö', 'üìö', '#10B981', true, 'd0d5e7a0-1111-1111-1111-111111111111', NOW()),
('c0c5e7a0-3333-3333-3333-333333333333', 'HR –Ω–æ–≤–æ—Å—Ç–∏', 'hr-news', '–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç HR –æ—Ç–¥–µ–ª–∞', 'üë•', '#F59E0B', true, 'd0d5e7a0-2222-2222-2222-222222222222', NOW())
ON CONFLICT (id) DO UPDATE SET
  name = EXCLUDED.name,
  description = EXCLUDED.description,
  updated_at = NOW();

-- 3. –°–æ–∑–¥–∞–µ–º –ø–æ—Å—Ç—ã –≤ –ª–µ–Ω—Ç–µ
INSERT INTO feed_posts (
    channel_id, 
    author_id, 
    title, 
    content, 
    excerpt,
    media_type,
    media_url,
    tags,
    published_at,
    created_at,
    updated_at
) VALUES 
(
    'c0c5e7a0-1111-1111-1111-111111111111',
    'd0d5e7a0-1111-1111-1111-111111111111',
    '–ó–∞–ø—É—Å–∫ –Ω–æ–≤–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è',
    E'–†–∞–¥—ã —Å–æ–æ–±—â–∏—Ç—å –æ –∑–∞–ø—É—Å–∫–µ –Ω–æ–≤–æ–π LMS –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã!\n\n–¢–µ–ø–µ—Ä—å –≤—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –º–æ–≥—É—Ç:\n- –ü—Ä–æ—Ö–æ–¥–∏—Ç—å –∫—É—Ä—Å—ã –≤ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è\n- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è\n- –ü–æ–ª—É—á–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã\n\n–ù–∞—á–Ω–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ —É–∂–µ —Å–µ–≥–æ–¥–Ω—è!',
    '–ó–∞–ø—É—â–µ–Ω–∞ –Ω–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è',
    'image',
    'https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=800',
    ARRAY['–æ–±—É—á–µ–Ω–∏–µ', '–Ω–æ–≤–æ—Å—Ç–∏', '–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞'],
    NOW(),
    NOW(),
    NOW()
),
(
    'c0c5e7a0-2222-2222-2222-222222222222',
    'd0d5e7a0-2222-2222-2222-222222222222',
    '–ù–æ–≤—ã–π –∫—É—Ä—Å: –û—Å–Ω–æ–≤—ã –ø—Ä–æ–µ–∫—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞',
    E'–û—Ç–∫—Ä—ã—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –∫—É—Ä—Å "–û—Å–Ω–æ–≤—ã –ø—Ä–æ–µ–∫—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞"!\n\n–í—ã –Ω–∞—É—á–∏—Ç–µ—Å—å:\n‚úì –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç—ã\n‚úì –£–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥–æ–π\n‚úì –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å—Ä–æ–∫–∏ –∏ –±—é–¥–∂–µ—Ç\n\n–°—Ç–∞—Ä—Ç –∫—É—Ä—Å–∞: 1 –∞–≤–≥—É—Å—Ç–∞ 2025',
    '–û—Ç–∫—Ä—ã—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—ã–π –∫—É—Ä—Å –ø–æ –ø—Ä–æ–µ–∫—Ç–Ω–æ–º—É –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É',
    NULL,
    NULL,
    ARRAY['–∫—É—Ä—Å—ã', '–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç', '–æ–±—É—á–µ–Ω–∏–µ'],
    NOW() - INTERVAL '1 day',
    NOW() - INTERVAL '1 day',
    NOW() - INTERVAL '1 day'
),
(
    'c0c5e7a0-3333-3333-3333-333333333333',
    'd0d5e7a0-2222-2222-2222-222222222222',
    '–ì—Ä–∞—Ñ–∏–∫ –æ—Ç–ø—É—Å–∫–æ–≤ –Ω–∞ –∞–≤–≥—É—Å—Ç',
    E'–ù–∞–ø–æ–º–∏–Ω–∞–µ–º –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–¥–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ –æ—Ç–ø—É—Å–∫ –¥–æ 31 –∏—é–ª—è.\n\n–§–æ—Ä–º–∞ –∑–∞—è–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.\n\n–ü—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ—Ç–ø—É—Å–∫–∞ —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É –≤–∞—à–µ–≥–æ –æ—Ç–¥–µ–ª–∞.',
    '–ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ–¥–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ—Ç–ø—É—Å–∫ –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞',
    NULL,
    NULL,
    ARRAY['hr', '–æ—Ç–ø—É—Å–∫', '–≤–∞–∂–Ω–æ'],
    NOW() - INTERVAL '2 days',
    NOW() - INTERVAL '2 days',
    NOW() - INTERVAL '2 days'
),
(
    'c0c5e7a0-1111-1111-1111-111111111111',
    'd0d5e7a0-1111-1111-1111-111111111111',
    '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–≤–∞—Ä—Ç–∞–ª–∞',
    E'–ü–æ–¥–≤–æ–¥–∏–º –∏—Ç–æ–≥–∏ –≤—Ç–æ—Ä–æ–≥–æ –∫–≤–∞—Ä—Ç–∞–ª–∞ 2025 –≥–æ–¥–∞.\n\n–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:\nüìà –†–æ—Å—Ç –ø—Ä–æ–¥–∞–∂ –Ω–∞ 15%\nüéØ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –Ω–∞ 112%\nüë• –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ 20 —á–µ–ª–æ–≤–µ–∫\n\n–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –≤—Å–µ—Ö –∑–∞ –æ—Ç–ª–∏—á–Ω—É—é —Ä–∞–±–æ—Ç—É!',
    '–ö–æ–º–ø–∞–Ω–∏—è –ø–æ–∫–∞–∑–∞–ª–∞ –æ—Ç–ª–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–æ –≤—Ç–æ—Ä–æ–º –∫–≤–∞—Ä—Ç–∞–ª–µ',
    'image',
    'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800',
    ARRAY['—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã', '–∫–≤–∞—Ä—Ç–∞–ª', '–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è'],
    NOW() - INTERVAL '3 days',
    NOW() - INTERVAL '3 days',
    NOW() - INTERVAL '3 days'
);

-- 4. –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
UPDATE feed_channels 
SET subscribers_count = (
    SELECT COUNT(DISTINCT author_id) 
    FROM feed_posts 
    WHERE channel_id = feed_channels.id
);

UPDATE feed_posts 
SET 
    likes_count = floor(random() * 20 + 5)::int,
    comments_count = floor(random() * 10)::int;

-- 5. –°–æ–∑–¥–∞–µ–º –ø–æ–¥–ø–∏—Å–∫–∏
INSERT INTO feed_subscriptions (user_id, channel_id, created_at) VALUES
('d0d5e7a0-1111-1111-1111-111111111111', 'c0c5e7a0-1111-1111-1111-111111111111', NOW()),
('d0d5e7a0-1111-1111-1111-111111111111', 'c0c5e7a0-2222-2222-2222-222222222222', NOW()),
('d0d5e7a0-2222-2222-2222-222222222222', 'c0c5e7a0-1111-1111-1111-111111111111', NOW()),
('d0d5e7a0-2222-2222-2222-222222222222', 'c0c5e7a0-3333-3333-3333-333333333333', NOW()),
('d0d5e7a0-3333-3333-3333-333333333333', 'c0c5e7a0-1111-1111-1111-111111111111', NOW())
ON CONFLICT (user_id, channel_id) DO NOTHING;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
SELECT 'Profiles:' as table_name, COUNT(*) as count FROM profiles
UNION ALL
SELECT 'Channels:', COUNT(*) FROM feed_channels
UNION ALL
SELECT 'Posts:', COUNT(*) FROM feed_posts
UNION ALL
SELECT 'Subscriptions:', COUNT(*) FROM feed_subscriptions; 