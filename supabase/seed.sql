-- Seed data for LMS production
-- Запустите этот скрипт после создания таблиц

-- Создание тестовых профилей
INSERT INTO profiles (id, full_name, role, department, position) VALUES
('d0d5e7a0-1111-1111-1111-111111111111', 'Администратор LMS', 'admin', 'IT', 'Системный администратор'),
('d0d5e7a0-2222-2222-2222-222222222222', 'Иван Иванов', 'instructor', 'Обучение', 'Тренер'),
('d0d5e7a0-3333-3333-3333-333333333333', 'Мария Петрова', 'student', 'Продажи', 'Менеджер');

-- Создание каналов ленты
INSERT INTO feed_channels (id, name, slug, description, icon, color, is_official, creator_id) VALUES
('c0d5e7a0-1111-1111-1111-111111111111', 'Новости компании', 'company-news', 'Официальные новости и объявления', 'megaphone', '#3B82F6', true, 'd0d5e7a0-1111-1111-1111-111111111111'),
('c0d5e7a0-2222-2222-2222-222222222222', 'Обучение и развитие', 'learning', 'Новости об обучающих программах', 'academic-cap', '#10B981', true, 'd0d5e7a0-2222-2222-2222-222222222222'),
('c0d5e7a0-3333-3333-3333-333333333333', 'HR новости', 'hr-news', 'Важная информация от HR', 'users', '#8B5CF6', true, 'd0d5e7a0-1111-1111-1111-111111111111');

-- Подписки на каналы (все подписаны на все каналы)
INSERT INTO feed_subscriptions (user_id, channel_id) VALUES
('d0d5e7a0-1111-1111-1111-111111111111', 'c0d5e7a0-1111-1111-1111-111111111111'),
('d0d5e7a0-1111-1111-1111-111111111111', 'c0d5e7a0-2222-2222-2222-222222222222'),
('d0d5e7a0-1111-1111-1111-111111111111', 'c0d5e7a0-3333-3333-3333-333333333333'),
('d0d5e7a0-2222-2222-2222-222222222222', 'c0d5e7a0-1111-1111-1111-111111111111'),
('d0d5e7a0-2222-2222-2222-222222222222', 'c0d5e7a0-2222-2222-2222-222222222222'),
('d0d5e7a0-2222-2222-2222-222222222222', 'c0d5e7a0-3333-3333-3333-333333333333'),
('d0d5e7a0-3333-3333-3333-333333333333', 'c0d5e7a0-1111-1111-1111-111111111111'),
('d0d5e7a0-3333-3333-3333-333333333333', 'c0d5e7a0-2222-2222-2222-222222222222'),
('d0d5e7a0-3333-3333-3333-333333333333', 'c0d5e7a0-3333-3333-3333-333333333333');

-- Создание курсов
INSERT INTO courses (id, title, description, instructor_id, category, difficulty, duration_hours, status) VALUES
('course-1111-1111-1111-111111111111', 'Основы продаж', 'Базовый курс по технике продаж для новых сотрудников', 'd0d5e7a0-2222-2222-2222-222222222222', 'Продажи', 'beginner', 8, 'published'),
('course-2222-2222-2222-222222222222', 'Управление проектами', 'Современные методологии управления проектами', 'd0d5e7a0-2222-2222-2222-222222222222', 'Менеджмент', 'intermediate', 16, 'published'),
('course-3333-3333-3333-333333333333', 'Excel для профессионалов', 'Продвинутые техники работы с Excel', 'd0d5e7a0-2222-2222-2222-222222222222', 'Программирование', 'advanced', 12, 'published');

-- Создание постов в ленте
INSERT INTO feed_posts (id, channel_id, author_id, title, content, excerpt, published_at) VALUES
('post-1111-1111-1111-111111111111', 
 'c0d5e7a0-1111-1111-1111-111111111111', 
 'd0d5e7a0-1111-1111-1111-111111111111', 
 'Добро пожаловать в новую LMS платформу!', 
 '<p>Рады представить вам нашу новую платформу для корпоративного обучения. Здесь вы найдете все необходимые курсы и материалы для вашего профессионального развития.</p><p>Начните с изучения каталога курсов и выберите интересующие вас программы.</p>', 
 'Запуск новой платформы корпоративного обучения',
 NOW() - INTERVAL '2 days'),

('post-2222-2222-2222-222222222222', 
 'c0d5e7a0-2222-2222-2222-222222222222', 
 'd0d5e7a0-2222-2222-2222-222222222222', 
 'Новый курс: Основы продаж', 
 '<p>Запускаем новый базовый курс по продажам! Курс предназначен для новых сотрудников отдела продаж и всех желающих улучшить свои навыки.</p><p>Продолжительность: 8 часов. Старт: в любое удобное время.</p>', 
 'Доступен новый курс для отдела продаж',
 NOW() - INTERVAL '1 day'),

('post-3333-3333-3333-333333333333', 
 'c0d5e7a0-3333-3333-3333-333333333333', 
 'd0d5e7a0-1111-1111-1111-111111111111', 
 'График работы в праздничные дни', 
 '<p>Уважаемые коллеги! Информируем вас о графике работы офиса в предстоящие праздничные дни.</p><p>Подробная информация доступна на корпоративном портале.</p>', 
 'Важная информация о режиме работы',
 NOW() - INTERVAL '12 hours');

-- Обновление счетчиков подписчиков
UPDATE feed_channels 
SET subscribers_count = (
  SELECT COUNT(*) FROM feed_subscriptions 
  WHERE channel_id = feed_channels.id
);

-- Добавление нескольких лайков и комментариев
INSERT INTO feed_reactions (post_id, user_id, type) VALUES
('post-1111-1111-1111-111111111111', 'd0d5e7a0-2222-2222-2222-222222222222', 'like'),
('post-1111-1111-1111-111111111111', 'd0d5e7a0-3333-3333-3333-333333333333', 'celebrate'),
('post-2222-2222-2222-222222222222', 'd0d5e7a0-3333-3333-3333-333333333333', 'like');

-- Обновление счетчиков реакций
UPDATE feed_posts 
SET likes_count = (
  SELECT COUNT(*) FROM feed_reactions 
  WHERE post_id = feed_posts.id
); 