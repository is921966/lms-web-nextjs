# üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã "profiles_role_check"

## –ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏

–í —Ç–∞–±–ª–∏—Ü–µ `profiles` –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—è `role`. –†–æ–ª—å `user` –Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞.

## üîç –®–∞–≥ 1: –£–∑–Ω–∞–π—Ç–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Ä–æ–ª–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Supabase SQL Editor**
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ —Ñ–∞–π–ª–∞ `supabase/check_constraints.sql`
3. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –Ω–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å `profiles_role_check`
4. –¢–∞–º –±—É–¥—É—Ç –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Ä–æ–ª–∏

–û–±—ã—á–Ω–æ —ç—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å:
- `admin`
- `employee` –∏–ª–∏ `staff`
- `student` 
- `instructor` –∏–ª–∏ `teacher`
- `moderator`

## ‚úÖ –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π SQL

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —É–∑–Ω–∞–µ—Ç–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Ä–æ–ª–∏, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π SQL:

```sql
-- –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ foreign key
ALTER TABLE profiles DROP CONSTRAINT IF EXISTS profiles_id_fkey;

-- –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª–∏ —Å –ü–†–ê–í–ò–õ–¨–ù–´–ú–ò —Ä–æ–ª—è–º–∏
-- –ó–∞–º–µ–Ω–∏—Ç–µ 'employee' –Ω–∞ —Ä–æ–ª—å –∏–∑ –≤–∞—à–µ–≥–æ —Å–ø–∏—Å–∫–∞!
INSERT INTO profiles (id, full_name, role, department, position) VALUES 
('d0d5e7a0-1111-1111-1111-111111111111', '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', 'admin', 'IT', '–ê–¥–º–∏–Ω'),
('d0d5e7a0-2222-2222-2222-222222222222', '–ú–∞—Ä–∏—è –ò.', 'employee', 'HR', '–ú–µ–Ω–µ–¥–∂–µ—Ä'),
('d0d5e7a0-3333-3333-3333-333333333333', '–ü–µ—Ç—Ä –°.', 'employee', '–ü—Ä–æ–¥–∞–∂–∏', '–ú–µ–Ω–µ–¥–∂–µ—Ä')
ON CONFLICT (id) DO UPDATE SET role = EXCLUDED.role;
```

## üéØ –®–∞–≥ 3: –ü–æ–ª–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å SQL –∏–∑:
```
supabase/seed_no_auth.sql
```

–ù–∞—á–∏–Ω–∞—è —Å —Ä–∞–∑–¥–µ–ª–∞ "-- 2. –°–æ–∑–¥–∞–µ–º –∫–∞–Ω–∞–ª—ã –ª–µ–Ω—Ç—ã"

## üöÄ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–æ–ª–∏, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —ç—Ç–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏:

### –í–∞—Ä–∏–∞–Ω—Ç A (–¥–ª—è LMS —Å–∏—Å—Ç–µ–º):
```sql
-- –†–æ–ª–∏: admin, student, instructor
('...', '–ê–¥–º–∏–Ω', 'admin', 'IT', '–ê–¥–º–∏–Ω'),
('...', '–ú–∞—Ä–∏—è', 'instructor', 'HR', '–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å'),
('...', '–ü–µ—Ç—Ä', 'student', '–ü—Ä–æ–¥–∞–∂–∏', '–°—Ç—É–¥–µ–Ω—Ç')
```

### –í–∞—Ä–∏–∞–Ω—Ç B (–¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º):
```sql
-- –†–æ–ª–∏: admin, staff, manager
('...', '–ê–¥–º–∏–Ω', 'admin', 'IT', '–ê–¥–º–∏–Ω'),
('...', '–ú–∞—Ä–∏—è', 'staff', 'HR', '–°–æ—Ç—Ä—É–¥–Ω–∏–∫'),
('...', '–ü–µ—Ç—Ä', 'staff', '–ü—Ä–æ–¥–∞–∂–∏', '–°–æ—Ç—Ä—É–¥–Ω–∏–∫')
```

## ‚ùì –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–í—Ä–µ–º–µ–Ω–Ω–æ —É–¥–∞–ª–∏—Ç–µ check constraint**:
```sql
ALTER TABLE profiles DROP CONSTRAINT profiles_role_check;
```

2. **–°–æ–∑–¥–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –≤ seed_no_auth.sql**

3. **–í production –≤–µ—Ä–Ω–∏—Ç–µ constraint –æ–±—Ä–∞—Ç–Ω–æ**

## üìå –ó–∞–ø–æ–º–Ω–∏—Ç–µ!

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –ª–µ–Ω—Ç–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç, –∑–∞–ø–∏—à–∏—Ç–µ –∫–∞–∫–∏–µ —Ä–æ–ª–∏ –ø–æ–¥–æ—à–ª–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è! 